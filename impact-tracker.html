<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EcoQuest | Real Impact Tracker</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .impact-dashboard {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 24px;
    }
    
    .impact-card {
      background: white;
      border-radius: 16px;
      padding: 24px;
      border: 2px solid var(--eco-border);
      transition: all 0.3s ease;
    }
    
    .impact-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    
    .impact-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }
    
    .impact-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      background: var(--eco-sage);
    }
    
    .impact-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin: 20px 0;
    }
    
    .stat-box {
      text-align: center;
      padding: 16px;
      background: var(--eco-sage);
      border-radius: 12px;
    }
    
    .stat-number {
      font-size: 28px;
      font-weight: bold;
      color: var(--eco-green);
      margin-bottom: 4px;
    }
    
    .stat-label {
      font-size: 12px;
      color: var(--eco-muted);
      font-weight: 500;
    }
    
    .impact-chart {
      height: 200px;
      background: var(--eco-sage);
      border-radius: 12px;
      display: flex;
      align-items: end;
      justify-content: space-around;
      padding: 20px;
      margin: 20px 0;
    }
    
    .chart-bar {
      width: 30px;
      background: linear-gradient(to top, var(--eco-green), var(--eco-green-dark));
      border-radius: 4px 4px 0 0;
      position: relative;
      transition: height 0.5s ease;
    }
    
    .chart-label {
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: var(--eco-muted);
    }
    
    .global-impact {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 16px;
      padding: 24px;
      margin: 20px 0;
    }
    
    .global-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin: 16px 0;
    }
    
    .global-stat {
      text-align: center;
      padding: 16px;
      background: rgba(255,255,255,0.1);
      border-radius: 12px;
      backdrop-filter: blur(10px);
    }
    
    .global-number {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 4px;
    }
    
    .milestone-card {
      background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      border-radius: 12px;
      padding: 20px;
      margin: 16px 0;
      color: #333;
    }
    
    .milestone-progress {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 12px 0;
    }
    
    .progress-bar {
      flex: 1;
      height: 12px;
      background: rgba(255,255,255,0.3);
      border-radius: 6px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff9a9e, #fecfef);
      transition: width 0.3s ease;
    }
    
    .carbon-calculator {
      background: linear-gradient(135deg, #4ecdc4, #44a08d);
      color: white;
      border-radius: 16px;
      padding: 24px;
      margin: 20px 0;
    }
    
    .calculator-input {
      display: flex;
      gap: 12px;
      margin: 12px 0;
      align-items: center;
    }
    
    .calculator-input input {
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      flex: 1;
    }
    
    .calculator-result {
      background: rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 16px;
      text-align: center;
      margin: 16px 0;
    }
    
    .leaderboard-mini {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin: 16px 0;
    }
    
    .leader-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 0;
      border-bottom: 1px solid var(--eco-border);
    }
    
    .leader-rank {
      width: 24px;
      text-align: center;
      font-weight: bold;
    }
    
    .leader-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
    }
    
    .leader-info {
      flex: 1;
    }
    
    .leader-name {
      font-weight: 600;
      font-size: 14px;
    }
    
    .leader-impact {
      font-size: 12px;
      color: var(--eco-muted);
    }
    
    .impact-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      margin: 2px;
    }
    
    .badge-bronze { background: #cd7f32; color: white; }
    .badge-silver { background: #c0c0c0; color: white; }
    .badge-gold { background: #ffd700; color: black; }
    .badge-platinum { background: #e5e4e2; color: black; }
    
    .real-world-connection {
      background: linear-gradient(135deg, #ff6b6b, #ff8e53);
      color: white;
      border-radius: 16px;
      padding: 24px;
      margin: 20px 0;
    }
    
    .connection-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      margin: 8px 0;
    }
    
    .connection-icon {
      font-size: 24px;
    }
    
    .connection-text {
      flex: 1;
    }
    
    .connection-value {
      font-weight: bold;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container nav">
      <a class="brand" href="index.html">
        <div class="logo"></div>
        <div class="title">EcoQuest</div>
      </a>
      <div class="nav-links">
        <a class="btn ghost" href="advanced-leaderboard.html">Leaderboard</a>
        <a class="btn ghost" href="social-hub.html">Social Hub</a>
        <a class="btn ghost" href="story-mode.html">Story Mode</a>
        <a class="btn ghost" href="impact-tracker.html">Impact Tracker</a>
        <a class="btn ghost" href="achievements.html">Achievements</a>
        <div id="authButtons" class="nav-links" style="display:none"></div>
        <div id="navUser" class="userbar" style="display:none">
          <img alt="avatar" src=""/>
          <span></span>
          <button id="logoutBtn" class="btn">Logout</button>
        </div>
      </div>
    </div>
  </header>

  <main class="container" style="padding-top:20px;">
    <h1 style="text-align: center; margin-bottom: 40px;">üåç Your Real-World Environmental Impact</h1>
    
    <div class="impact-dashboard">
      <!-- Main Impact Tracking -->
      <div>
        <!-- Personal Impact Card -->
        <div class="impact-card">
          <div class="impact-header">
            <div class="impact-icon">üå±</div>
            <div>
              <h2>Your Environmental Impact</h2>
              <p class="helper">Track how your EcoQuest actions translate to real-world change</p>
            </div>
          </div>
          
          <div class="impact-stats">
            <div class="stat-box">
              <div class="stat-number" id="carbonSaved">2.4</div>
              <div class="stat-label">Tons CO‚ÇÇ Saved</div>
            </div>
            <div class="stat-box">
              <div class="stat-number" id="treesEquivalent">48</div>
              <div class="stat-label">Trees Equivalent</div>
            </div>
            <div class="stat-box">
              <div class="stat-number" id="waterSaved">1,250</div>
              <div class="stat-label">Liters Water Saved</div>
            </div>
          </div>
          
          <div class="impact-chart" id="impactChart">
            <div class="chart-bar" style="height: 60px;">
              <div class="chart-label">Jan</div>
            </div>
            <div class="chart-bar" style="height: 80px;">
              <div class="chart-label">Feb</div>
            </div>
            <div class="chart-bar" style="height: 120px;">
              <div class="chart-label">Mar</div>
            </div>
            <div class="chart-bar" style="height: 100px;">
              <div class="chart-label">Apr</div>
            </div>
            <div class="chart-bar" style="height: 140px;">
              <div class="chart-label">May</div>
            </div>
            <div class="chart-bar" style="height: 90px;">
              <div class="chart-label">Jun</div>
            </div>
          </div>
          
          <div style="display: flex; gap: 12px;">
            <div class="impact-badge badge-bronze">ü•â Carbon Reducer</div>
            <div class="impact-badge badge-silver">ü•à Water Saver</div>
            <div class="impact-badge badge-gold">ü•á Eco Champion</div>
          </div>
        </div>
        
        <!-- Real-World Connections -->
        <div class="real-world-connection">
          <h3>üîó Real-World Connections</h3>
          <p>See how your virtual actions create actual environmental benefits</p>
          
          <div class="connection-item">
            <div class="connection-icon">üå≥</div>
            <div class="connection-text">
              <div>Trees Planted Virtually</div>
              <div style="font-size: 12px;">Partners with One Tree Planted</div>
            </div>
            <div class="connection-value">127</div>
          </div>
          
          <div class="connection-item">
            <div class="connection-icon">‚ôªÔ∏è</div>
            <div class="connection-text">
              <div>Recycling Actions</div>
              <div style="font-size: 12px;">Supports local recycling programs</div>
            </div>
            <div class="connection-value">89</div>
          </div>
          
          <div class="connection-item">
            <div class="connection-icon">‚ö°</div>
            <div class="connection-text">
              <div>Energy Saved (kWh)</div>
              <div style="font-size: 12px;">Renewable energy investments</div>
            </div>
            <div class="connection-value">340</div>
          </div>
          
          <div class="connection-item">
            <div class="connection-icon">üåä</div>
            <div class="connection-text">
              <div>Ocean Cleanup Actions</div>
              <div style="font-size: 12px;">Partners with Ocean Conservancy</div>
            </div>
            <div class="connection-value">56</div>
          </div>
        </div>
        
        <!-- Carbon Calculator -->
        <div class="carbon-calculator">
          <h3>üßÆ Personal Carbon Calculator</h3>
          <p>Calculate your daily carbon footprint and see improvement suggestions</p>
          
          <div class="calculator-input">
            <span>üöó Daily commute (km):</span>
            <input type="number" id="commute" placeholder="10" onchange="calculateCarbon()">
          </div>
          
          <div class="calculator-input">
            <span>‚ö° Monthly electricity (kWh):</span>
            <input type="number" id="electricity" placeholder="300" onchange="calculateCarbon()">
          </div>
          
          <div class="calculator-input">
            <span>üçΩÔ∏è Meat meals per week:</span>
            <input type="number" id="meat" placeholder="7" onchange="calculateCarbon()">
          </div>
          
          <div class="calculator-result">
            <div style="font-size: 24px; font-weight: bold;" id="carbonResult">2.1 tons CO‚ÇÇ/year</div>
            <div style="font-size: 14px;">Your estimated annual carbon footprint</div>
          </div>
          
          <button class="btn" style="background: rgba(255,255,255,0.2); color: white; width: 100%;">
            üìä Get Personalized Reduction Plan
          </button>
        </div>
      </div>
      
      <!-- Side Panel -->
      <div>
        <!-- Global Impact -->
        <div class="global-impact">
          <h3>üåç Global EcoQuest Impact</h3>
          <p>Combined impact of all EcoQuest users worldwide</p>
          
          <div class="global-stats">
            <div class="global-stat">
              <div class="global-number">47,892</div>
              <div>Active Eco Warriors</div>
            </div>
            <div class="global-stat">
              <div class="global-number">2.1M</div>
              <div>Trees Planted</div>
            </div>
            <div class="global-stat">
              <div class="global-number">15,670</div>
              <div>Tons CO‚ÇÇ Reduced</div>
            </div>
            <div class="global-stat">
              <div class="global-number">890K</div>
              <div>Plastic Items Recycled</div>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 16px;">
            <button class="btn" style="background: rgba(255,255,255,0.2); color: white;">
              üåê View Global Map
            </button>
          </div>
        </div>
        
        <!-- Milestones -->
        <div class="milestone-card">
          <h4>üéØ Next Milestone</h4>
          <div><strong>Plant 50 Virtual Trees</strong></div>
          <div class="milestone-progress">
            <div class="progress-bar">
              <div class="progress-fill" style="width: 74%"></div>
            </div>
            <span>37/50</span>
          </div>
          <div style="font-size: 12px;">Reward: Real tree planted + 100 points</div>
        </div>
        
        <div class="milestone-card">
          <h4>üèÜ Impact Leaderboard</h4>
          <div class="leaderboard-mini">
            <div class="leader-item">
              <div class="leader-rank">1</div>
              <img class="leader-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='14' fill='%2322c55e'/%3E%3Ctext x='16' y='20' font-size='12' text-anchor='middle' fill='white'%3EA%3C/text%3E%3C/svg%3E" alt="avatar">
              <div class="leader-info">
                <div class="leader-name">Aarya Sharma</div>
                <div class="leader-impact">3.2 tons CO‚ÇÇ saved</div>
              </div>
            </div>
            <div class="leader-item">
              <div class="leader-rank">2</div>
              <img class="leader-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='14' fill='%2322c55e'/%3E%3Ctext x='16' y='20' font-size='12' text-anchor='middle' fill='white'%3EV%3C/text%3E%3C/svg%3E" alt="avatar">
              <div class="leader-info">
                <div class="leader-name">Vihaan Patel</div>
                <div class="leader-impact">2.8 tons CO‚ÇÇ saved</div>
              </div>
            </div>
            <div class="leader-item">
              <div class="leader-rank">3</div>
              <img class="leader-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='14' fill='%2322c55e'/%3E%3Ctext x='16' y='20' font-size='12' text-anchor='middle' fill='white'%3EY%3C/text%3E%3C/svg%3E" alt="avatar">
              <div class="leader-info">
                <div class="leader-name">You</div>
                <div class="leader-impact">2.4 tons CO‚ÇÇ saved</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Weekly Challenge -->
        <div class="milestone-card" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
          <h4 style="color: white;">‚ö° Weekly Impact Challenge</h4>
          <div style="color: white;"><strong>Reduce 100kg CO‚ÇÇ as a community</strong></div>
          <div class="milestone-progress">
            <div class="progress-bar">
              <div class="progress-fill" style="width: 67%; background: rgba(255,255,255,0.8);"></div>
            </div>
            <span style="color: white;">67kg/100kg</span>
          </div>
          <div style="font-size: 12px; color: rgba(255,255,255,0.8);">2 days remaining</div>
        </div>
        
        <!-- Impact Tips -->
        <div class="impact-card">
          <h4>üí° Daily Eco Tips</h4>
          <div style="padding: 12px; background: var(--eco-sage); border-radius: 8px; margin: 8px 0;">
            <strong>üöø Tip of the Day:</strong> Taking shorter showers can save up to 2,300 gallons of water per year!
          </div>
          <div style="padding: 12px; background: var(--eco-sage); border-radius: 8px; margin: 8px 0;">
            <strong>‚ôªÔ∏è Did you know?</strong> Recycling one aluminum can saves enough energy to power a TV for 3 hours!
          </div>
          <button class="btn primary" style="width: 100%;">
            üì± Get More Tips
          </button>
        </div>
      </div>
    </div>
  </main>

  <script src="app.js"></script>
  <script src="ai-chatbot.js"></script>
  <script>
    const user = Eco.requireAuth();
    
    // User's impact data (in real app, this would be calculated from activities)
    const impactData = {
      carbonSaved: 2.4, // tons
      treesEquivalent: 48,
      waterSaved: 1250, // liters
      monthlyProgress: [0.3, 0.4, 0.6, 0.5, 0.7, 0.45], // tons CO‚ÇÇ per month
      activities: {
        treesPlanted: 127,
        recyclingActions: 89,
        energySaved: 340, // kWh
        oceanCleanup: 56
      }
    };
    
    // Update impact statistics
    function updateImpactStats() {
      document.getElementById('carbonSaved').textContent = impactData.carbonSaved.toFixed(1);
      document.getElementById('treesEquivalent').textContent = impactData.treesEquivalent;
      document.getElementById('waterSaved').textContent = impactData.waterSaved.toLocaleString();
    }
    
    // Calculate carbon footprint
    function calculateCarbon() {
      const commute = parseFloat(document.getElementById('commute').value) || 0;
      const electricity = parseFloat(document.getElementById('electricity').value) || 0;
      const meat = parseFloat(document.getElementById('meat').value) || 0;
      
      // Simple carbon calculation (tons CO‚ÇÇ per year)
      const commuteCarbon = (commute * 365 * 0.0002); // kg CO‚ÇÇ per km
      const electricityCarbon = (electricity * 12 * 0.0005); // kg CO‚ÇÇ per kWh
      const meatCarbon = (meat * 52 * 0.027); // kg CO‚ÇÇ per meat meal
      
      const totalCarbon = (commuteCarbon + electricityCarbon + meatCarbon) / 1000; // convert to tons
      
      document.getElementById('carbonResult').textContent = totalCarbon.toFixed(1) + ' tons CO‚ÇÇ/year';
      
      // Provide feedback
      if (totalCarbon < 2) {
        document.getElementById('carbonResult').style.color = '#22c55e';
      } else if (totalCarbon < 4) {
        document.getElementById('carbonResult').style.color = '#f59e0b';
      } else {
        document.getElementById('carbonResult').style.color = '#ef4444';
      }
    }
    
    // Animate chart bars
    function animateChart() {
      const bars = document.querySelectorAll('.chart-bar');
      bars.forEach((bar, index) => {
        setTimeout(() => {
          const height = impactData.monthlyProgress[index] * 200; // scale to chart height
          bar.style.height = height + 'px';
        }, index * 200);
      });
    }
    
    // Simulate real-time updates
    function simulateRealTimeUpdates() {
      // Randomly update global stats
      const globalStats = document.querySelectorAll('.global-number');
      globalStats.forEach(stat => {
        const currentValue = parseInt(stat.textContent.replace(/[^\d]/g, ''));
        const increment = Math.floor(Math.random() * 5) + 1;
        const newValue = currentValue + increment;
        
        if (stat.textContent.includes('K')) {
          stat.textContent = (newValue / 1000).toFixed(0) + 'K';
        } else if (stat.textContent.includes('M')) {
          stat.textContent = (newValue / 1000000).toFixed(1) + 'M';
        } else {
          stat.textContent = newValue.toLocaleString();
        }
      });
    }
    
    // Award impact points for activities
    function awardImpactPoints(activity, amount) {
      if (user) {
        const impactPoints = Math.floor(amount * 10); // Convert impact to points
        Eco.awardPoints(user, impactPoints, `Environmental Impact: ${activity}`);
        
        // Update impact stats
        impactData.carbonSaved += amount * 0.01;
        impactData.treesEquivalent = Math.floor(impactData.carbonSaved * 20);
        impactData.waterSaved += amount * 5;
        
        updateImpactStats();
        
        // Show notification
        showImpactNotification(`+${amount.toFixed(2)} tons CO‚ÇÇ saved! Keep up the great work! üå±`);
      }
    }
    
    // Show impact notification
    function showImpactNotification(message) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, var(--eco-green), var(--eco-green-dark));
        color: white;
        padding: 16px 24px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        z-index: 1000;
        animation: slideIn 0.3s ease;
        max-width: 300px;
      `;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
      }, 4000);
    }
    
    // Check for new activities (simulate integration with other parts of the app)
    function checkForNewActivities() {
      // In a real app, this would check user's recent activities
      if (Math.random() < 0.05) { // 5% chance per check
        const activities = [
          { name: 'Tree Planting', impact: 0.1 },
          { name: 'Recycling Challenge', impact: 0.05 },
          { name: 'Energy Saving', impact: 0.08 },
          { name: 'Water Conservation', impact: 0.03 }
        ];
        
        const randomActivity = activities[Math.floor(Math.random() * activities.length)];
        awardImpactPoints(randomActivity.name, randomActivity.impact);
      }
    }
    
    // Initialize
    updateImpactStats();
    calculateCarbon();
    
    // Animate chart after page load
    setTimeout(animateChart, 500);
    
    // Start real-time updates
    setInterval(simulateRealTimeUpdates, 10000); // Update every 10 seconds
    setInterval(checkForNewActivities, 5000); // Check for activities every 5 seconds
    
    // Make functions global
    window.calculateCarbon = calculateCarbon;
    
    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
